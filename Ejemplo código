from Modelo import ControladorModelo
from BD import VariableBD
from Variables import Variable

# md = Modelo("E:/Javad/Python-Julien/Kutuj/Interfaz/Ejemplo.csv")
ctrl = ControladorModelo('C:/Users/iarna/PycharmProjects/Kutuj/Interfaz/Ejemplo.csv')
ctrl.base_central.estab_col_fecha('Fecha')
ctrl.base_central.estab_col_hora('Hora')

varBD = VariableBD(nombre='Lluvia diaria', base=ctrl.base_central, columna='Lluvia [Acu] [mm]', interpol='trap',
                   transformación='sumar')

print(varBD.datos)

varY = Variable(receta={'Nombre': 'Lluvia crítica', 'MétodoCalc': 'val_tot', 'FiltroVal': 'ninguno',
                        'FiltroTmpInic': 100, 'RefTmpInic': 'abs', 'FiltroTmpFin': 200, 'RefTmpFin': 'abs'},
                fuente=varBD)

varX1 = Variable(receta={'Nombre': 'Lluvia a fecha', 'MétodoCalc': 'val_tot', 'FiltroVal': 'ninguno',
                         'FiltroTmpInic': 1, 'RefTmpInic': 'abs', 'FiltroTmpFin': 0, 'RefTmpFin': 'rel'},
                 fuente=varBD)

print(varX1.datos)

varX2 = Variable(receta={'Nombre': 'Lluvia -10', 'MétodoCalc': 'val_tot', 'FiltroVal': 'ninguno',
                         'FiltroTmpInic': 1, 'RefTmpInic': 'abs', 'FiltroTmpFin': -10, 'RefTmpFin': 'rel'},
                 fuente=varBD)

ctrl.Modelo.varsX = {'Lluvia a fecha': varX1, 'Lluvia -10': varX2}
ctrl.Modelo.varY = varY

ctrl.Modelo.actualizar_datos()

# ctrl.Modelo.calibrar()

# ctrl.Modelo.guardar_calib(archivo='C:/Users/iarna/PycharmProjects/Kutuj/Datos_ejemplos/Ejemplo_calib.txt')

ctrl.Modelo.cargar_calib('C:/Users/iarna/PycharmProjects/Kutuj/Datos_ejemplos/Ejemplo_calib.txt')

ctrl.Modelo.predecir(n_día=10)
